from sqlalchemy.orm import Session
import app.models as models
import app.schemas as schemas
import app.crud.users as users


def get_by_id(db: Session, id: int):
    return db.query(models.Projet).filter(models.Projet.id == id).first()


def get_all(db: Session):
    Projets = db.query(models.Projet).all()
    projects = []
    for pro in Projets:
        p = {}
        p["id"] = pro.id
        p["total"] = pro.total
        p["date"] = pro.date
        p["name"] = pro.name
        p["high"] = pro.high
        p["medium"] = pro.medium
        p["low"] = pro.low
        p["description"] = pro.description
        p["createdby"] = users.get_user(db, pro.idu).name
        projects.append(p)
    return projects


def delete(db: Session, id: int):
    Projet = db.query(models.Projet).filter(models.Projet.id == id).first()
    db.delete(Projet)
    db.commit()


def create(db: Session, Projet: schemas.Projet, idu: int):
    Projet = models.Projet(name=Projet.name, date=Projet.date, total=Projet.total, high=Projet.high,
                           medium=Projet.medium, low=Projet.low, idu=idu, description=Projet.description)
    db.add(Projet)
    db.commit()
